<!DOCTYPE html>
<html>

<head>
    <title>Golang Dummy Web Service</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/milligram/1.3.0/milligram.css">
</head>

<body>

    <div class="container" style="margin-top: 5rem">

        <div class="row">
            <div class="column column-50">

                <h1>Controls</h1>
                <button onclick="setHealth(false)" class="button">Set unhealthy</button>
                <button onclick="setHealth(true)" class="button">Set healthy</button>
                <a href="./shutdown" class="button">Initiate Shutdown</a>

                <h1>Links</h1>
                <a href="./health" class="button button-outline">Health status</a>
                <a href="./info" class="button button-outline">Info</a>

            </div>
            <div class="column column-50">

                <h1>Current Health Status</h1>
                <pre><code id="current-health"></code></pre>
                <svg width="44" height="44" viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg" stroke="#9b4dca" id="loader" style="position: absolute; top: 6rem; right: 0.5rem; display: none">
                    <g fill="none" fill-rule="evenodd" stroke-width="2">
                        <circle cx="22" cy="22" r="2" fill="#9b4dca"></circle>
                    </g>
                </svg>

            </div>
        </div>
    </div>

    <script>
        setInterval(fetchHealthStatus, 1000);

        function fetchHealthStatus() {
            fetch('/health'
            ).then(response => response.json()
            ).then(jsonData => {
                document.getElementById('loader').style.display = 'block';
                setTimeout(() => {
                    document.getElementById('loader').style.display = 'none';
                }, 200);
                document.getElementById('current-health').innerHTML = JSON.stringify(jsonData);
            }).catch(err => {
            });
        }

        function setHealth(status) {
            fetch(`/health/${status}`
            ).then(response => {
                console.log(response);
            }).catch(err => {
                console.error(err);
            });
        }
    </script>
</body>

</html>